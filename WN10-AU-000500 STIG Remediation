<#
.SYNOPSIS
    This PowerShell script ensures that the maximum size of the Windows Application event log is at least 32768 KB (32 MB).

.NOTES
    Author          : Ciprian Ghiur
    LinkedIn        : https://www.linkedin.com/in/ciprian-ghiur-440777139/
    GitHub          : github.com/joshmadakor1
    Date Created    : 27-05-2025
    Last Modified   : 27-05-2025
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : N/A
    STIG-ID         : WN10-AU-000500

.TESTED ON
    Date(s) Tested  :  27-05-2025
    Tested By       : 
    Systems Tested  : 
    PowerShell Ver. : 

.USAGE
    Put any usage instructions here.
    PS C:\> .\__remediation_template(STIG-ID-WN10-AU-000500).ps1 
#>
# Dimensiunea minimă dorită (în kilobyți)
$minLogSizeKB = 32768
$logName = "Application"

# Obține dimensiunea actuală folosind wevtutil
$currentLogInfo = wevtutil gl $logName

# Extrage dimensiunea curentă din ieșirea comenzii
$currentSizeLine = $currentLogInfo | Where-Object { $_ -match "^maximumSize:" }
$currentSizeBytes = [int]($currentSizeLine -replace "maximumSize:\s+", "")
$currentSizeKB = [math]::Round($currentSizeBytes / 1024)

# Compară și actualizează dacă e nevoie
if ($currentSizeKB -lt $minLogSizeKB) {
    Write-Output "Dimensiunea curentă: $currentSizeKB KB. Se face update la $minLogSizeKB KB..."
    wevtutil sl $logName /ms:($minLogSizeKB * 1024)
    Write-Output "Dimensiunea a fost actualizată cu succes."
} else {
    Write-Output "Dimensiunea actuală ($currentSizeKB KB) este suficientă. Nu se face nicio modificare."
}
